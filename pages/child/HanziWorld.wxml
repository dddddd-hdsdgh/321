<!--pages/child/HanziWorld.wxml-->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-title">æ±‰å­—ä¸–ç•Œ</view>
  
  <!-- å­¦ä¹ æ¨¡å¼é€‰æ‹© -->
  <view class="mode-selector">
    <view 
      wx:for="{{learningModes}}" 
      wx:key="id"
      class="mode-item {{currentMode === item.id ? 'active' : ''}}"
      bindtap="switchMode"
      data-mode="{{item.id}}"
    >
      {{item.name}}
    </view>
  </view>
  
  <!-- æ±‰å­—è®¤çŸ¥æ¨¡å¼ -->
  <view class="recognition-mode" wx:if="{{currentMode === 'recognition'}}">
    <view class="recognition-title">ç‚¹å‡»ä¸‹æ–¹æ±‰å­—å­¦ä¹ </view>
    
    <!-- æ±‰å­—ç½‘æ ¼ -->
    <view class="hanzi-grid">
      <view 
        wx:for="{{hanzis}}" 
        wx:key="id"
        class="hanzi-item"
        style="background-color: {{item.color}}30; border-color: {{item.color}};"
        bindtap="selectHanzi"
        data-id="{{item.id}}"
      >
        <text class="hanzi-character">{{item.character}}</text>
        <text class="hanzi-pinyin">{{item.pinyin}}</text>
      </view>
    </view>
    
    <!-- å½“å‰é€‰ä¸­æ±‰å­—è¯¦æƒ… -->
    <view class="current-hanzi" wx:if="{{currentHanzi}}" style="background-color: {{currentHanzi.color}}20; border-color: {{currentHanzi.color}};">
      <view class="hanzi-detail-header">
        <text class="hanzi-detail-character">{{currentHanzi.character}}</text>
        <view class="sound-btn" bindtap="playHanziSound">ğŸ”Š</view>
      </view>
      <view class="hanzi-detail-info">
        <text class="hanzi-detail-pinyin">{{currentHanzi.pinyin}}</text>
        <text class="hanzi-detail-meaning">{{currentHanzi.meaning}}</text>
      </view>
      <view class="hanzi-detail-strokes">
        <text class="strokes-title">ç¬”ç”»: {{currentHanzi.strokes.length}}ç”»</text>
      </view>
    </view>
  </view>
  
  <!-- ç¬”ç”»ç»ƒä¹ æ¨¡å¼ -->
  <view class="writing-mode" wx:if="{{currentMode === 'writing'}}">
    <view class="writing-title">ç¬”ç”»ç»ƒä¹ </view>
    
    <!-- æ±‰å­—é€‰æ‹© -->
    <view class="writing-hanzi-selector">
      <scroll-view scroll-x="true" class="horizontal-scroll">
        <view 
          wx:for="{{hanzis}}" 
          wx:key="id"
          class="writing-hanzi-item {{currentHanzi.id === item.id ? 'selected' : ''}}"
          style="background-color: {{currentHanzi.id === item.id ? item.color : '#f0f0f0'}};"
          bindtap="selectHanzi"
          data-id="{{item.id}}"
        >
          {{item.character}}
        </view>
      </scroll-view>
    </view>
    
    <!-- ç¬”ç”»ç»ƒä¹ åŒº -->
    <view class="strokes-practice" wx:if="{{currentHanzi}}" style="border-color: {{currentHanzi.color}};">
      <view class="strokes-header">
        <text class="current-hanzi-big">{{currentHanzi.character}}</text>
        <text class="stroke-progress">{{currentStrokeIndex + 1}}/{{currentHanzi.strokes.length}}</text>
      </view>
      
      <view class="strokes-display">
        <text class="strokes-label">å½“å‰ç¬”ç”»:</text>
        <text class="strokes-name">{{currentHanzi.strokes[currentStrokeIndex]}}</text>
      </view>
      
      <view class="strokes-drawing-area">
        <!-- ç®€åŒ–çš„ç¬”ç”»å±•ç¤ºåŒºåŸŸ -->
        <view class="drawing-canvas">
          <!-- è¿™é‡Œå¯ä»¥æ”¾ç½®canvasç»„ä»¶å®ç°çœŸå®çš„ç¬”ç”»ç»ƒä¹  -->
          <text class="drawing-hint">è¯·æŒ‰ç…§ç¬”ç”»é¡ºåºç»ƒä¹ </text>
        </view>
      </view>
      
      <view class="strokes-controls">
        <button class="control-btn" bindtap="prevStroke" disabled="{{currentStrokeIndex === 0}}">ä¸Šä¸€ç¬”</button>
        <button class="control-btn" bindtap="restartStrokes">é‡æ–°å¼€å§‹</button>
        <button class="control-btn" bindtap="nextStroke" disabled="{{currentStrokeIndex === currentHanzi.strokes.length - 1}}">ä¸‹ä¸€ç¬”</button>
      </view>
    </view>
  </view>
  
  <!-- äº’åŠ¨æ¸¸æˆæ¨¡å¼ -->
  <view class="game-mode" wx:if="{{currentMode === 'game'}}">
    <view class="game-title">æ±‰å­—é…å¯¹æ¸¸æˆ</view>
    
    <view class="game-score">å¾—åˆ†: {{score}}</view>
    
    <!-- æ¸¸æˆé—®é¢˜ -->
    <view class="game-question" wx:if="{{gameHanzi}}">
      <text class="question-text">è¯·æ‰¾å‡º:</text>
      <text class="question-hanzi">{{gameHanzi.character}}</text>
      <text class="question-pinyin">({{gameHanzi.pinyin}})</text>
    </view>
    
    <!-- æ¸¸æˆé€‰é¡¹ -->
    <view class="game-options" wx:if="{{gameOptions.length > 0}}">
      <view 
        wx:for="{{gameOptions}}" 
        wx:key="id"
        class="game-option {{selectedOption === item.id.toString() ? 'selected' : ''}}"
        style="background-color: {{selectedOption === item.id.toString() ? item.color : '#f0f0f0'}};"
        bindtap="selectGameOption"
        data-id="{{item.id}}"
      >
        {{item.character}}
      </view>
    </view>
    
    <!-- æäº¤æŒ‰é’® -->
    <view class="game-actions">
      <button class="submit-game-btn" bindtap="submitGameAnswer" disabled="{{!selectedOption}}">æäº¤ç­”æ¡ˆ</button>
    </view>
  </view>
</view>