<!--pages/child/Settings.wxml-->
<view class="settings-container">
  <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
  <view class="user-info-section" bindtap="toggleChildSelector">
    <view class="user-avatar">
      <view class="avatar-placeholder">{{userInfo && userInfo.avatar ? userInfo.avatar : 'ğŸ‘§'}}</view>
    </view>
    <view class="user-details">
      <view class="user-name">{{userInfo && userInfo.name ? userInfo.name : 'å°æœ‹å‹'}}</view>
      <view class="user-type">{{userInfo && userInfo.grade ? userInfo.grade : 'å°å­¦ç”Ÿç”¨æˆ·'}} <text class="switch-hint">ç‚¹å‡»åˆ‡æ¢</text></view>
    </view>
    <view class="user-arrow">â€º</view>
  </view>

  <!-- å­¦ä¹ è®¾ç½®åŒºåŸŸ -->
  <view class="settings-section">
    <view class="section-title">å­¦ä¹ è®¾ç½®</view>
    
    <!-- å£°éŸ³è®¾ç½® -->
    <view class="setting-item">
      <view class="setting-label">
        <view class="setting-icon">ğŸ”Š</view>
        <text>å£°éŸ³æ•ˆæœ</text>
      </view>
      <switch checked="{{studySettings.sound}}" bindchange="toggleSound" color="#4ecdc4" />
    </view>
    
    <!-- éŸ³ä¹è®¾ç½® -->
    <view class="setting-item">
      <view class="setting-label">
        <view class="setting-icon">ğŸµ</view>
        <text>èƒŒæ™¯éŸ³ä¹</text>
      </view>
      <switch checked="{{studySettings.music}}" bindchange="toggleMusic" color="#4ecdc4" />
    </view>
    
    <!-- é€šçŸ¥è®¾ç½® -->
    <view class="setting-item">
      <view class="setting-label">
        <view class="setting-icon">ğŸ””</view>
        <text>å­¦ä¹ æé†’</text>
      </view>
      <switch checked="{{studySettings.notifications}}" bindchange="toggleNotifications" color="#4ecdc4" />
    </view>
  </view>

  <!-- éš¾åº¦è®¾ç½®åŒºåŸŸ -->
  <view class="settings-section">
    <view class="section-title">éš¾åº¦è®¾ç½®</view>
    <view class="difficulty-options">
      <view 
        wx:for="{{difficulties}}" 
        wx:key="value"
        class="difficulty-option {{studySettings.difficulty === item.value ? 'active' : ''}}"
        data-difficulty="{{item.value}}"
        bindtap="changeDifficulty"
      >
        {{item.name}}
      </view>
    </view>
  </view>

  <!-- å…¶ä»–æ“ä½œåŒºåŸŸ -->
  <view class="settings-section">
    <view class="section-title">å…¶ä»–æ“ä½œ</view>
    
    <!-- å®¶é•¿ç®¡ç† -->
    <view class="action-item" bindtap="switchToParentMode">
      <view class="action-label">
        <view class="action-icon">ğŸ‘ª</view>
        <text>å®¶é•¿ç®¡ç†</text>
      </view>
      <view class="action-arrow">â€º</view>
    </view>
    
    <!-- æ¸…é™¤ç¼“å­˜ -->
    <view class="action-item" bindtap="clearCache">
      <view class="action-label">
        <view class="action-icon">ğŸ—‘ï¸</view>
        <text>æ¸…é™¤ç¼“å­˜</text>
      </view>
      <view class="action-arrow">â€º</view>
    </view>
    
    <!-- å…³äºæˆ‘ä»¬ -->
    <view class="action-item" bindtap="aboutUs">
      <view class="action-label">
        <view class="action-icon">â„¹ï¸</view>
        <text>å…³äºæˆ‘ä»¬</text>
      </view>
      <view class="action-arrow">â€º</view>
    </view>
  </view>

  <!-- ç‰ˆæœ¬ä¿¡æ¯ -->
  <view class="version-info">
    èŒè±†è¯­æ–‡åŠ¨ç”»å±‹ v1.0.0
  </view>
</view>

<!-- å„¿ç«¥é€‰æ‹©å™¨å¼¹çª— -->
<view wx:if="{{showChildSelector}}" class="child-selector-mask">
  <view class="child-selector">
    <view class="selector-header">
      <text class="selector-title">é€‰æ‹©å°æœ‹å‹</text>
      <view class="close-button" bindtap="toggleChildSelector">âœ•</view>
    </view>
    <view class="child-list">
      <view 
        wx:for="{{children}}" 
        wx:key="id"
        class="child-item {{currentChildIndex === index ? 'selected' : ''}}"
        data-index="{{index}}"
        bindtap="selectChild"
      >
        <view class="child-avatar">{{item.avatar}}</view>
        <view class="child-info">
          <view class="child-name">{{item.name}}</view>
          <view class="child-grade">{{item.grade}}</view>
        </view>
        <view wx:if="{{currentChildIndex === index}}" class="selected-mark">âœ“</view>
      </view>
    </view>
  </view>
</view>