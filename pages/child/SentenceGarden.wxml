<!--pages/child/SentenceGarden.wxml-->
<!--pages/child/SentenceGarden.wxml-->
<view class="sentence-garden-container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-title">å¥å­ä¹å›­</view>
  
  <!-- å­¦ä¹ æ¨¡å¼åˆ‡æ¢ -->
  <view class="mode-switcher">
    <view class="mode-tab {{learningMode === 'browse' ? 'active' : ''}}" data-mode="browse" bindtap="switchLearningMode">
      æµè§ˆæ¨¡å¼
    </view>
    <view class="mode-tab {{learningMode === 'practice' ? 'active' : ''}}" data-mode="practice" bindtap="switchLearningMode">
      ç»ƒä¹ æ¨¡å¼
    </view>
  </view>
  
  <!-- æµè§ˆæ¨¡å¼ -->
  <view wx:if="{{learningMode === 'browse'}}" class="browse-mode">
    <!-- åˆ†ç±»é€‰æ‹© -->
    <view class="category-selector">
      <view class="horizontal-scroll">
        <view 
          wx:for="{{sentenceCategories}}" 
          wx:key="id"
          class="category-item {{currentCategory === item.id ? 'active' : ''}}"
          data-category="{{item.id}}"
          bindtap="switchCategory"
        >
          {{item.name}}
        </view>
      </view>
    </view>
    
    <!-- å¥å­åˆ—è¡¨ -->
    <view class="sentences-list">
      <view wx:if="{{loading}}" class="loading">
        <view class="loading-spinner"></view>
        <text>åŠ è½½ä¸­...</text>
      </view>
      
      <block wx:elif="{{sentences.length > 0}}">
        <view wx:for="{{sentences}}" wx:key="id" class="sentence-item" data-id="{{item.id}}" bindtap="viewSentenceDetail">
          <view class="sentence-text">{{item.text}}</view>
          <view class="sentence-pinyin">{{item.pinyin}}</view>
          <view class="sentence-meaning">{{item.meaning}}</view>
          <view class="arrow-icon">â–¶ï¸</view>
        </view>
      </block>
      
      <view wx:else class="empty-state">
        <view class="empty-icon">ğŸ“</view>
        <text>æš‚æ— å¥å­å†…å®¹</text>
      </view>
    </view>
  </view>
  
  <!-- ç»ƒä¹ æ¨¡å¼ -->
  <view wx:elif="{{learningMode === 'practice'}}" class="practice-mode">
    <!-- ç»ƒä¹ è¿›åº¦ -->
    <view class="practice-progress">
      <text>é—®é¢˜ {{practice.currentQuestionIndex}}/{{practice.totalQuestions}}</text>
      <text class="score">å¾—åˆ†: {{practice.score}}</text>
    </view>
    
    <!-- é—®é¢˜åŒºåŸŸ -->
    <view wx:if="{{practice.currentQuestion}}" class="question-area">
      <view class="question-header">
        <text>è¯·é€‰æ‹©å¥å­çš„æ­£ç¡®å«ä¹‰</text>
      </view>
      
      <view class="question-sentence">
        <view class="sentence-original">{{practice.currentQuestion.text}}</view>
        <view class="sentence-pronunciation">{{practice.currentQuestion.pinyin}}</view>
      </view>
      
      <!-- é€‰é¡¹åŒºåŸŸ -->
      <view class="options-area">
        <view 
          wx:for="{{practice.options}}" 
          wx:key="index"
          class="option-item {{practice.selectedOption === item ? 'selected' : ''}} {{practice.isCorrect !== null && practice.selectedOption === item ? (practice.isCorrect ? 'correct' : 'wrong') : ''}}"
          data-option="{{item}}"
          bindtap="selectOption"
        >
          {{item}}
        </view>
      </view>
      
      <!-- ç»“æœåé¦ˆ -->
      <view wx:if="{{practice.isCorrect !== null}}" class="feedback-area">
        <view wx:if="{{practice.isCorrect}}" class="correct-feedback">
          <view class="feedback-icon">âœ…</view>
          <text>å›ç­”æ­£ç¡®ï¼</text>
        </view>
        <view wx:else class="wrong-feedback">
          <view class="feedback-icon">âŒ</view>
          <text>å›ç­”é”™è¯¯ï¼</text>
          <view class="correct-answer">æ­£ç¡®ç­”æ¡ˆï¼š{{practice.currentQuestion.meaning}}</view>
        </view>
      </view>
      
      <!-- æäº¤æŒ‰é’® -->
      <view wx:if="{{practice.isCorrect === null}}" class="submit-btn" bindtap="submitAnswer">
        æäº¤ç­”æ¡ˆ
      </view>
    </view>
    
    <view wx:else class="no-question">
      <text>è¯·ç­‰å¾…åŠ è½½é¢˜ç›®...</text>
    </view>
  </view>
  
  <!-- å¥å­è¯¦æƒ…å¼¹çª— -->
  <view wx:if="{{showDetail && selectedSentence}}" class="sentence-detail-modal">
    <view class="modal-content">
      <view class="modal-header">
        <view class="modal-title">å¥å­è¯¦æƒ…</view>
        <view class="close-btn" bindtap="closeSentenceDetail">âœ•</view>
      </view>
      
      <view class="detail-content">
        <!-- å¥å­å†…å®¹ -->
        <view class="sentence-display">
          <view class="detail-sentence">{{selectedSentence.text}}</view>
          <view class="detail-pinyin">{{selectedSentence.pinyin}}</view>
          <view class="detail-meaning">{{selectedSentence.meaning}}</view>
        </view>
        
        <!-- å‘éŸ³æŒ‰é’® -->
        <view class="sound-section">
          <button class="sound-btn" bindtap="handlePlaySound" data-text="{{selectedSentence.text}}" disabled="{{!soundEnabled}}">
            {{soundEnabled ? 'ğŸ”Š æ’­æ”¾å‘éŸ³' : 'ğŸ”‡ å£°éŸ³å·²å…³é—­'}}
          </button>
        </view>
        
        <!-- ä¾‹å¥ -->
        <view class="example-section">
          <view class="example-title">ä¾‹å¥ï¼š</view>
          <view class="example-text">{{selectedSentence.example}}</view>
        </view>
      </view>
    </view>
  </view>
</view>