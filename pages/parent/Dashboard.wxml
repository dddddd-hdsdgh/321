<!-- å®¶é•¿ä»ªè¡¨ç›˜é¡µé¢ -->
<view class="parent-dashboard-container">
  <!-- é¡¶éƒ¨æ  -->
  <view class="header">
    <view class="header-left">
      <image class="header-icon" src="./../../images/icon.png" mode="aspectFit"></image>
      <view class="header-title">èŒè±†è¯­æ–‡åŠ¨ç”»å±‹</view>
    </view>
    <view class="header-right">
      <view class="notification-icon" bindtap="showNotifications">ğŸ””</view>
      <view class="parent-avatar" bindtap="showUserMenu">ğŸ‘¤</view>
    </view>
  </view>

  <!-- æ¬¢è¿ä¿¡æ¯ -->
  <view class="welcome-section">
    <view class="welcome-text">
      <text class="greeting">æ‚¨å¥½ï¼Œå®¶é•¿</text>
      <text class="welcome-subtitle">ä»Šå¤©ä¹Ÿæ˜¯å­©å­è¿›æ­¥çš„ä¸€å¤©</text>
    </view>
    <view class="date-display">{{currentDate}}</view>
  </view>

  <!-- å„¿ç«¥ä¿¡æ¯å¡ç‰‡ -->
  <view class="child-info-card">
    <view class="child-avatar">{{children[currentChildIndex].avatar || 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§'}}</view>
    <view class="child-details">
      <view class="child-name">{{children[currentChildIndex].name}}</view>
      <view class="child-meta">{{children[currentChildIndex].age}}å² | {{children[currentChildIndex].grade}}</view>
      <view class="child-status {{children[currentChildIndex].status === 'online' ? 'status-online' : 'status-offline'}}">
        {{children[currentChildIndex].status === 'online' ? 'æ­£åœ¨å­¦ä¹ ' : 'ç¦»çº¿'}}
      </view>
    </view>
    <view class="child-switch-button" bindtap="toggleChildSelector">
      åˆ‡æ¢å„¿ç«¥ âŒµ
    </view>
  </view>

  <!-- å­¦ä¹ ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-card">
    <view class="section-header">
      <view class="section-title">å­¦ä¹ ç»Ÿè®¡</view>
      <view class="view-more" bindtap="goToStatistics">æŸ¥çœ‹å…¨éƒ¨ ></view>
    </view>
    <view class="stats-grid">
      <view class="stat-item">
        <view class="stat-icon">â°</view>
        <view class="stat-value">{{children[currentChildIndex].studyStats.totalStudyTime}}</view>
        <view class="stat-label">æ€»å­¦ä¹ æ—¶é•¿</view>
      </view>
      <view class="stat-item">
        <view class="stat-icon">ğŸ“š</view>
        <view class="stat-value">{{children[currentChildIndex].studyStats.completedLessons}}</view>
        <view class="stat-label">å·²å®Œæˆè¯¾ç¨‹</view>
      </view>
      <view class="stat-item">
        <view class="stat-icon">ğŸ”¥</view>
        <view class="stat-value">{{children[currentChildIndex].studyStats.currentStreak}}å¤©</view>
        <view class="stat-label">è¿ç»­å­¦ä¹ </view>
      </view>
      <view class="stat-item">
        <view class="stat-icon">ğŸ†</view>
        <view class="stat-value">{{children[currentChildIndex].studyStats.achievements}}</view>
        <view class="stat-label">è·å¾—æˆå°±</view>
      </view>
    </view>
  </view>

  <!-- æœ€è¿‘å­¦ä¹ è®°å½• -->
  <view class="recent-studies-card">
    <view class="section-header">
      <view class="section-title">æœ€è¿‘å­¦ä¹ </view>
      <view class="view-more" bindtap="viewAllStudies">æŸ¥çœ‹å…¨éƒ¨ ></view>
    </view>
    <view class="recent-studies-list">
      <block wx:if="{{children[currentChildIndex].recentStudies.length > 0}}">
        <view wx:for="{{children[currentChildIndex].recentStudies}}" wx:key="index" class="study-item">
          <view class="study-icon">{{item.icon || 'ğŸ“–'}}</view>
          <view class="study-details">
            <view class="study-title">{{item.title}}</view>
            <view class="study-meta">
              <text>{{item.time}}</text>
              <text>{{item.progress}}%</text>
            </view>
          </view>
          <view class="study-status {{item.completed ? 'completed' : 'in-progress'}}">
            {{item.completed ? 'å·²å®Œæˆ' : 'è¿›è¡Œä¸­'}}
          </view>
        </view>
      </block>
      <view wx:else class="empty-state">
        æš‚æ— å­¦ä¹ è®°å½•
      </view>
    </view>
  </view>

  <!-- ç®¡ç†åŠŸèƒ½åˆ—è¡¨ -->
  <view class="management-section">
    <view class="section-title">å®¶é•¿åŠŸèƒ½</view>
    <view class="management-grid">
      <view class="management-item" bindtap="goToCourses">
        <view class="management-icon">ğŸ“š</view>
        <view class="management-text">è¯¾ç¨‹ç®¡ç†</view>
      </view>
      <view class="management-item" bindtap="goToStatistics">
        <view class="management-icon">ğŸ“Š</view>
        <view class="management-text">å­¦ä¹ æ•°æ®</view>
      </view>
      <view class="management-item" bindtap="manageChildren">
        <view class="management-icon">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</view>
        <view class="management-text">å„¿ç«¥ç®¡ç†</view>
      </view>
      <view class="management-item" bindtap="goToParentSettings">
        <view class="management-icon">âš™ï¸</view>
        <view class="management-text">æˆ‘çš„è®¾ç½®</view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-bar">
    <view class="switch-to-child" bindtap="switchToChildMode">
      <view class="switch-icon">ğŸ‘¶</view>
      <view class="switch-text">åˆ‡æ¢åˆ°å„¿ç«¥æ¨¡å¼</view>
    </view>
  </view>

  <!-- å„¿ç«¥é€‰æ‹©å™¨å¼¹çª— -->
  <view class="child-selector-mask" wx:if="{{showChildSelector}}" bindtap="toggleChildSelector"></view>
  <view class="child-selector" wx:if="{{showChildSelector}}">
    <view class="selector-header">
      <text class="selector-title">é€‰æ‹©å­©å­</text>
      <view class="selector-close" bindtap="toggleChildSelector">Ã—</view>
    </view>
    <view class="selector-content">
      <view class="add-child-btn" bindtap="addNewChild">
        <view class="add-icon">+</view>
        <view class="add-text">æ·»åŠ å­©å­</view>
      </view>
      <view class="child-list">
        <view 
          class="child-item {{index === currentChildIndex ? 'active' : ''}}"
          wx:for="{{children}}" 
          wx:key="id"
          data-index="{{index}}"
          bindtap="selectChild"
        >
          <view class="child-item-avatar">{{index === 0 ? 'ğŸ‘¶' : 'ğŸ§’'}}</view>
          <view class="child-item-info">
            <view class="child-item-name">{{item.name}}</view>
            <view class="child-item-meta">{{item.age}}å² | {{item.grade}}</view>
          </view>
          <view class="child-item-check" wx:if="{{index === currentChildIndex}}">âœ“</view>
        </view>
      </view>
    </view>
  </view>
</view>